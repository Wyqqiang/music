<!doctype html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jQuery和CSS3响应式TAB选项卡样式幻灯片特效|DEMO_jQuery之家-自由分享jQuery、html5、css3的插件库</title>
    <link rel="stylesheet" href="/static/css/reset.css">
    <link rel="stylesheet" type="/static/text/css" href="css/htmleaf-demo.css">
    <link href="http://cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="stylesheet" type="text/css" href="/static/css/normalize.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/default.css">
    <link href="/static/css/pagination.css" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="/static/css/reset02.css" rel="stylesheet" type="text/css">
    <link href="/static/css/style02.css" rel="stylesheet" type="text/css">
    <link href="/static/css/normalize02.css" rel="stylesheet" type="text/css">
    <link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/component.css" rel="stylesheet" type="text/css">
    <link href="/static/css/htmleaf-demo02.css" rel="stylesheet" type="text/css">
</head>
<style type="text/css">
    a:hover, a:focus {
        text-decoration: none;
        outline: none;
    }

    #accordion {
        padding-left: 76px;
        overflow: hidden;
        position: relative;
        z-index: 1;
    }

    #accordion:before {
        content: "";
        width: 1px;
        height: 90%;
        background: #9d325b;
        position: absolute;
        top: 0;
        left: 22px;
        z-index: -1;
    }

    #accordion .panel {
        border: none;
        box-shadow: none;
        border-radius: 0;
    }

    #accordion .panel-heading {
        padding: 0;
        border-radius: 0;
        border: none;
    }

    #accordion .panel-title a {
        display: block;
        font-size: 16px;
        font-weight: bold;
        color: #31162e;
        padding: 10px 30px 15px 0;
        background: #fff;
        position: relative;
        transition: all 0.5s ease 0s;
    }

    #accordion .panel-title a:before {
        content: "\f05b";
        font-family: fontawesome;
        font-size: 20px;
        color: #fff;
        width: 40px;
        height: 40px;
        line-height: 40px;
        text-align: center;
        background: #9d325b;
        border: 1px solid #9d325b;
        position: absolute;
        top: 0;
        left: -74px;
    }

    #accordion .panel-title a.collapsed:before {
        color: #9c335b;
        background: #fff;
    }

    #accordion .panel-body {
        font-size: 14px;
        color: #487677;
        line-height: 25px;
        padding: 5px 15px 15px 0;
        border: none;
    }
</style>
<body>
<section class="htmleaf-container">
    <div class="landing-slider">
        <!--tabSlider-->
        <div class="tabSlider">
            <!--
                作者：offline
                时间：2020-07-11
                描述：三个操作按钮
            -->
            <nav class="ts-control">
                <div class="ts-container">
                    <ul>
                        <li class="is-active"><i class="fa fa-music" aria-hidden="true"></i> <span>Slide 1</span></li>
                        <li><i class="fa fa-folder-open" aria-hidden="true"></i> <span>Slide 2</span></li>
                        <li><i class="fa fa-commenting-o" aria-hidden="true"></i><span>Slide 3</span></li>
                    </ul>
                </div>
            </nav>
            <div class="ts-items">
                <!-- Single item -->
                <div class="ts-item is-active">
                    <div class="ts-banner"><img src="/static/img/621.jpg" alt="alt goes here"/></div>
                    <div class="ts-container set-layout thumb-cont">
                        <div class="ts-thumbnail"><img src="/static/img/iphone.png" alt="alt"/></div>
                        <div class="ts-content">
                            <!--<div class="ts-title"> 进来听歌呗 </div>-->
                            <a id="sing"> <span>不来听首歌吗？</span> <small>music</small>
                                <i class="fa fa-arrow-circle-right"></i>
                            </a>
                        </div>
                        <article class="htmleaf-container article" style="display: none">
                            <div id="wrapper">
                                <section>
                                    <div class="data-container container"></div>
                                    <ul id="mypage"></ul>
                                </section>
                            </div>
                        </article>
                    </div>
                    <div class="container" style="display: none">
                        <div class="row">
                            <div class="col-xs-10">
                                <audio style="width: 80%" controls="controls" src="/static/music/Amy.mp3"
                                       id="music"></audio>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Singleitem -->
                <div class="ts-item">
                    <div class="ts-banner"><img src="/static/img/622.jpg" alt="alt goes here"/></div>
                    <div class="ts-container set-layout thumb-cont">
                        <div class="ts-thumbnail"><img src="/static/img/s3.png" alt="alt"/></div>
                        <div class="ts-content">
                            <!-- <div class="ts-title"> 上传歌曲 </div>-->
                            <a id="upload" class="ts-btn pull-right set-icon to-right">
                                <span>我也传首歌</span> <small></small> <i class="fa fa-arrow-circle-right"></i>
                            </a>
                        </div>

                        <article class="htmleaf-container" style="display: none">
                            <section>
                                <form role="form" action="/upload" enctype="multipart/form-data" method="post">
                                    <div class="form-group">
                                        <label>文件输入</label>
                                        <input type="file" name="file">
                                        <p class="help-block">这里是块级帮助文本的实例。</p>
                                    </div>
                                    <button type="submit" class="btn btn-default">提交</button>
                                </form>
                            </section>
                        </article>
                    </div>
                </div>
                <!-- Single item -->
                <div class="ts-item">
                    <div class="ts-banner"><img src="/static/img/623.jpg" alt="alt goes here"/></div>
                    <div class="ts-container set-layout thumb-cont">
                        <div class="ts-thumbnail"><img src="/static/img/lumia.png" alt="alt"/></div>
                        <div class="ts-content">
                            <a id="other_message" class="ts-btn pull-right set-icon to-right"
                               style="background: #3498DB;margin-bottom: 10px;">
                                <span>偷看下别人的留言，咳咳</span>
                                <small>Praesent at enim vel nibh</small>
                                <i class="fa fa-arrow-circle-right"></i>
                            </a>
                            <a id="my_message" class="ts-btn pull-right set-icon to-right">
                                <span>我也留个言</span>
                                <small>Praesent at enim vel nibh</small>
                                <i class="fa fa-arrow-circle-right"></i>
                            </a>
                        </div>
                        <!--看别人的留言开始-->
                        <div id="message" style="display: none">
                            <div class="demo" style="padding: 1em 0;min-height: 350px;">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-offset-3 col-md-6">
                                            <div class="panel-group" id="accordion" role="tablist"
                                                 aria-multiselectable="true">
                                                <div class="panel panel-default">
                                                    <div class="panel-heading" role="tab" id="headingOne">
                                                        <h4 class="panel-title">
                                                            <a id="a1" role="button" data-toggle="collapse"
                                                               data-parent="#accordion" href="#collapseOne"
                                                               aria-expanded="true" aria-controls="collapseOne">
                                                                Section 1
                                                            </a>
                                                        </h4>
                                                    </div>
                                                    <div id="collapseOne" class="panel-collapse collapse in"
                                                         role="tabpanel" aria-labelledby="headingOne">
                                                        <div class="panel-body">
                                                            <p id="p1">Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                                                                Praesent nisl lorem, dictum id pellentesque at,
                                                                vestibulum ut arcu. Curabitur erat libero, egestas eu
                                                                tincidunt ac, rutrum ac justo. Vivamus condimentum
                                                                laoreet lectus, blandit posuere tortor aliquam vitae.
                                                                Curabitur molestie eros. </p>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="panel panel-default">
                                                    <div class="panel-heading" role="tab" id="headingTwo">
                                                        <h4 class="panel-title">
                                                            <a id="a2" class="collapsed" role="button" data-toggle="collapse"
                                                               data-parent="#accordion" href="#collapseTwo"
                                                               aria-expanded="false" aria-controls="collapseTwo">
                                                                Section 2
                                                            </a>
                                                        </h4>
                                                    </div>
                                                    <div id="collapseTwo" class="panel-collapse collapse"
                                                         role="tabpanel" aria-labelledby="headingTwo">
                                                        <div class="panel-body">
                                                            <p id="p2">Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                                                                Praesent nisl lorem, dictum id pellentesque at,
                                                                vestibulum ut arcu. Curabitur erat libero, egestas eu
                                                                tincidunt ac, rutrum ac justo. Vivamus condimentum
                                                                laoreet lectus, blandit posuere tortor aliquam vitae.
                                                                Curabitur molestie eros. </p>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="panel panel-default">
                                                    <div class="panel-heading" role="tab" id="headingThree">
                                                        <h4 class="panel-title">
                                                            <a id="a3" class="collapsed" role="button" data-toggle="collapse"
                                                               data-parent="#accordion" href="#collapseThree"
                                                               aria-expanded="false" aria-controls="collapseThree">
                                                                Section 3
                                                            </a>
                                                        </h4>
                                                    </div>
                                                    <div id="collapseThree" class="panel-collapse collapse"
                                                         role="tabpanel" aria-labelledby="headingThree">
                                                        <div class="panel-body">
                                                            <p id="p3">Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                                                                Praesent nisl lorem, dictum id pellentesque at,
                                                                vestibulum ut arcu. Curabitur erat libero, egestas eu
                                                                tincidunt ac, rutrum ac justo. Vivamus condimentum
                                                                laoreet lectus, blandit posuere tortor aliquam vitae.
                                                                Curabitur molestie eros. </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--分页-->
                                        <ul id="messagePage"></ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--结束-->


                        <!--写留言开始-->
                        <div class="container" id="container" style="display: none">

                                <form action="/save_message">
                                    <h2 style="margin-bottom: 20px">来，把你想说的话说出来。。。。</h2>
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <textarea style="height: 150px;width: 100%;background: #3498db;opacity: 0.8"  name="message" type="text"></textarea>
                                        </div>
                                    </div>
                                    <div class="row" style="margin-top: 20px">
                                        <div class="col-xs-8">

                                        </div>
                                        <div class="col-xs-4">
                                            <input type="submit" class="btn"  style="background: #3498db" value="确定">
                                        </div>
                                    </div>
                                </form>
                        </div>
                        <!--写留言结束-->
                    </div>
                </div>
            </div>
        </div>
</section>
<input id="status" th:value="${status}" style="display: none">
<!--themeleaf中不能使用request中的值-->
<script src="/static/js/jquery-2.1.1.min.js"></script>
<!--<script src="/static/js/pagination.js"></script>-->
<script src="/static/js/jquery.flexslider-min.js"></script>
<script src="/static/js/main.js"></script>
<script src="/static/js/masonry.pkgd.min.js"></script>
<script src="/static/js/modernizr.js"></script>
<script src="/static/js/classie.js"></script>
<!--分页插件-->
<script src="/static/js/page.js"></script>
<!--bootstrap引入-->
<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script type="text/javascript">
    //点击跳转的操作
    $(function () {
        var status = $("#status").val();
        if (status == "success") {
            $('.ts-item').eq(0).find(".ts-content").css("display", "none");
            $('.ts-item').eq(0).find("article").css("display", "block");
            $('.ts-item').eq(0).find(".container").css("display", "block")
        }
        //点击听歌
        $("#sing").click(function () {
            $('.ts-item').eq(0).find(".ts-content").css("display", "none");
            $('.ts-item').eq(0).find("article").css("display", "block");
            $('.ts-item').eq(0).find(".container").css("display", "block")
        })
        //点击传歌的跳转
        $("#upload").click(function () {
            $('.ts-item').eq(1).find(".ts-content").css("display", "none");
            $('.ts-item').eq(1).find("article").css("display", "block");
            //alert(1)
        })
        //点击查看别人的留言
        $("#other_message").click(function () {
            $('.ts-item').eq(2).find(".ts-content").css("display", "none");
            $('.ts-item').eq(2).find("#message").css("display", "block");

            $('.ts-item').eq(2).find("#container").css("display", "none");
        })
        //自己写留言
        $("#my_message").click(function () {
            $('.ts-item').eq(2).find(".ts-content").css("display", "none");
            $('.ts-item').eq(2).find("#container").css("display", "block");
        })

        //$('a').on('click', function(){ return false; });
        // set item banner
        $('.ts-item').first().show();
        $('.ts-item').each(function () {
            var $this = $(this),
                _imgSrc = $this.find('.ts-banner img').attr('src');
            if (_imgSrc)
                $this.css('background-image', 'url(' + _imgSrc + ')');
        });
        $('.ts-control li').on('click', function () {
            var $this = $(this),
                _index = $this.index();
            $("li.is-active").removeClass("is-active");
            $(this).addClass("is-active");
            $('.ts-item.is-active').removeClass('is-active').fadeOut();
            $('.ts-item').eq(_index).addClass('is-active').fadeIn();
            $('.ts-item').eq(0).find(".ts-content").css("display", "block");
            $('.ts-item').eq(0).find("article").css("display", "none");
            $('.ts-item').eq(0).find(".container").css("display", "none")

            $('.ts-item').eq(1).find(".ts-content").css("display", "block");
            $('.ts-item').eq(1).find("article").css("display", "none");

            $('.ts-item').eq(2).find(".ts-content").css("display", "block");
            $('.ts-item').eq(2).find("#message").css("display", "none");

            $('.ts-item').eq(2).find("#container").css("display", "none");
            return false;
        });
        var ww = $(window).width();
    });
    //加载列表数据
    $(function () {
        //音乐分页处理
        pageStart();//开始分页
        function pageStart() {//分页函数
            $.ajax({ //去后台查询第一页数据
                type: "get",
                url: "/find_music",
                dataType: "json",
                data: {page: '1', size: '3'}, //参数：当前页为1
                success: function (data) {
                    appendHtml(data.list);//处理第一页的数据
                    downLoad();
                    var options = {//根据后台返回的分页相关信息，设置插件参数
                        bootstrapMajorVersion: 3, //如果是bootstrap3版本需要加此标识，并且设置包含分页内容的DOM元素为UL,如果是bootstrap2版本，则DOM包含元素是DIV
                        currentPage: data.page, //当前页数
                        totalPages: data.totalPage, //总页数
                        numberOfPages: data.pageSize,//每页记录数
                        itemTexts: function (type, page, current) {//设置分页按钮显示字体样式
                            switch (type) {
                                case "first":
                                    return "首页";
                                case "prev":
                                    return "上一页";
                                case "next":
                                    return "下一页";
                                case "last":
                                    return "末页";
                                case "page":
                                    return page;
                            }
                        },
                        onPageClicked: function (event, originalEvent, type, page) {//分页按钮点击事件
                            $.ajax({//根据page去后台加载数据
                                url: "/find_music",
                                type: "get",
                                dataType: "json",
                                data: {"page": page, size: '3'},
                                success: function (data) {
                                    appendHtml(data.list);//处理数据
                                    music_click();
                                    downLoad();
                                }
                            });
                        }
                    };
                    $('#mypage').bootstrapPaginator(options);//设置分页
                    music_click();
                }
            });
        }

        //添加数据
        function appendHtml(list) {//此函数用于处理后台返回的数据，根据自己需求来实现页面拼接
            var tableShow = '';
            tableShow += '<table class="table"><tr style="background: #3498db"><td>歌曲名</td><td>歌手</td><td>操作</td></tr>';
            for (var i = 0; i < list.length; i++) {
                tableShow += '<tr class="row"><td class="col-xs-3">' + list[i].name + '</td>';
                tableShow += '<td class="col-xs-3">' + list[i].singer + '<img src="'+list[i].imgPath+'"></td>';
                tableShow += '<td class="col-xs-3"><button type="button" class="play btn btn-info" id=' + list[i].path + '><i class="fa fa-play-circle" aria-hidden="true"></i> </button> &nbsp;<a href="" type="button" id= '+list[i].path+' class="down btn btn-primary"><i class="fa fa-download" aria-hidden="true"></i></a></td></tr>';
            }
            tableShow += "</table>";
            $('.data-container').html(tableShow)
        }

        //歌曲的切换
        music_click();
        function music_click() {
            //歌曲的切换
            $(".play").click(function () {
                //获取到你所定义的音频标签
                var audios = document.getElementById("music");
                //获取当前歌曲的路径
                var path = $(this).attr("id");
                //停止播放
                audios.pause();
                //这种方式是js的，不是jq的方式设置src
                audios.src = path;
                //重新加载
                audios.load();
                //播放
                audios.play();
            })
        }
        //留言部分的分页实现
        messagePageStart();
        function messagePageStart() {//分页函数
            $.ajax({ //去后台查询第一页数据
                type: "get",
                url: "/find_message",
                dataType: "json",
                data: {page: '1', size: '3'}, //参数：当前页为1
                success: function (data) {
                    updateMessage(data.list);
                    //alert(data.list[0].message);
                    //appendHtml(data.list);//处理第一页的数据
                    var options = {//根据后台返回的分页相关信息，设置插件参数
                        bootstrapMajorVersion: 3, //如果是bootstrap3版本需要加此标识，并且设置包含分页内容的DOM元素为UL,如果是bootstrap2版本，则DOM包含元素是DIV
                        currentPage: data.page, //当前页数
                        totalPages: data.totalPage, //总页数
                        numberOfPages: data.pageSize,//每页记录数
                        itemTexts: function (type, page, current) {//设置分页按钮显示字体样式
                            switch (type) {
                                case "first":
                                    return "首页";
                                case "prev":
                                    return "上一页";
                                case "next":
                                    return "下一页";
                                case "last":
                                    return "末页";
                                case "page":
                                    return page;
                            }
                        },
                        onPageClicked: function (event, originalEvent, type, page) {//分页按钮点击事件
                            $.ajax({//根据page去后台加载数据
                                url: "/find_message",
                                type: "get",
                                dataType: "json",
                                data: {"page": page, size: '3'},
                                success: function (data) {
                                    updateMessage(data.list);
                                    //appendHtml(data.list);//处理数据
                                }
                            });
                        }
                    };
                    $('#messagePage').bootstrapPaginator(options);//设置分页
                }
            });
        }

        //对留言板的内容进行替换
        function updateMessage(list) {
            for (var i = 0; i < list.length; i++) {
                $("#p"+(i+1)).text(list[i].message);
                $("#a"+(i+1)).text(getLocalTime(list[i].date));
            }
        }
        //时间戳转成时间
        function getLocalTime(nS) {
            return new Date(parseInt(nS)).toLocaleString();
        }

        //下载请求
        function downLoad(){
            $(".down").click(function () {
                var path=$(this).attr("id");// /static/music/Amy.mp3
                var localObj = window.location; //这个的意思是获取当前页面的地址
                var protocol = location.protocol; //获取http或https
                var host = localObj.host; //获取JSP地址栏IP和端口号 //localhost:8080
                var contextPath = localObj.pathname.split("/")[1]; //获取项目名
                var basePath = protocol +"//"+host;
                alert(basePath);
                var url = basePath+"/download?filename="+encodeURI(encodeURI(path));
                $(this).attr("href",url);
            })
        }

    });
</script>
</body>
</html>